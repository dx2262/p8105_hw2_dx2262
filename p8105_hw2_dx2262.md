p8105_hw2_dx2262
================

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   4.0.0     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
    ## ✔ purrr     1.0.4     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(readxl)
```

## Problem 2

Load the dataset

Mr. Trash Wheel:

``` r
Mr_df <- 
  read_excel("data/202509 Trash Wheel Collection Data.xlsx", 
             sheet = 1, 
             skip = 1, 
             na = c("NA", ".", "")) %>% 
  janitor::clean_names() %>% 
  select(-x15, -x16) %>% 
  mutate(sports_balls = as.integer(round(sports_balls, 0)),
         wheel = "mr",
         year = as.numeric(year)) %>% 
  relocate(wheel, everything())
```

    ## New names:
    ## • `` -> `...15`
    ## • `` -> `...16`

Professor Trash Wheel:

``` r
Prof_df <- 
  read_excel("data/202509 Trash Wheel Collection Data.xlsx", 
             sheet = 2, 
             skip = 1, 
             na = c("NA", ".", "")) %>% 
  janitor::clean_names() %>% 
  mutate(wheel = "prof",
         year = as.numeric(year)) %>% 
  relocate(wheel, everything())
```

Gwynns:

``` r
GF_df <- 
  read_excel("data/202509 Trash Wheel Collection Data.xlsx", 
             sheet = 4, 
             skip = 1, 
             na = c("NA", ".", "")) %>% 
  janitor::clean_names() %>% 
  mutate(wheel = "gwynns",
         year = as.numeric(year)) %>% 
  relocate(wheel, everything())
```

Combine datasets

``` r
TrashWheel_df <- bind_rows(Mr_df, Prof_df, GF_df)
```

The total number of observations in the resulting dataset is 1191.

Key variables are wheel, dumpster, month, year, date, weight_tons,
volume_cubic_yards, plastic_bottles, polystyrene, cigarette_butts,
glass_bottles, plastic_bags, wrappers, sports_balls, homes_powered.

The total weight of trash collected by Professor Trash Wheel is 564.52

The total number of cigarette butts collected by Gwynns in June of 2022
is 1.812^{4}.

## Problem 3

Load datasets

``` r
zip_codes_df <- 
  read.csv("data/Zip Codes.csv", na = c("NA", ".", "")) %>% 
  janitor::clean_names()
```

``` r
housing_df <- 
  read.csv("data/Zip_zori_uc_sfrcondomfr_sm_month_NYC.csv", na = c("NA", ".", "")) %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    cols = x2015_01_31:x2024_08_31,
    names_to = "date",
    values_to = "price",
    names_prefix = "x"
  ) %>% 
  drop_na() %>% 
  rename(
    zip_code = region_name
  )
```

Combine datasets

``` r
housing_by_zip_df <- 
  left_join(housing_df, zip_codes_df, by = "zip_code") %>% 
  relocate(zip_code, size_rank, date, price, everything())
```

    ## Warning in left_join(housing_df, zip_codes_df, by = "zip_code"): Detected an unexpected many-to-many relationship between `x` and `y`.
    ## ℹ Row 2759 of `x` matches multiple rows in `y`.
    ## ℹ Row 256 of `y` matches multiple rows in `x`.
    ## ℹ If a many-to-many relationship is expected, set `relationship =
    ##   "many-to-many"` to silence this warning.

The total number of observations is 10677.

There are 149 unique ZIP codes, and 43 unique neighborhoods.

Which ZIP codes appear in the ZIP code dataset but not in the Zillow
Rental Price dataset? Using a few illustrative examples discuss why
these ZIP codes might be excluded from the Zillow dataset.

``` r
missing_zip <- 
  anti_join(zip_codes_df, housing_df, by = "zip_code") %>% 
  distinct(zip_code) %>% 
  pull(zip_code)

missing_zip
```

    ##   [1] 10464 10474 10475 10499 10550 10704 10705 10803 11202 11224 11239 11241
    ##  [13] 11242 11243 11245 11247 11251 11252 11256 10008 10020 10041 10043 10045
    ##  [25] 10047 10048 10055 10072 10080 10081 10082 10087 10101 10102 10103 10104
    ##  [37] 10105 10106 10107 10108 10109 10110 10111 10112 10113 10114 10115 10116
    ##  [49] 10117 10118 10119 10120 10121 10122 10123 10124 10125 10126 10129 10130
    ##  [61] 10131 10132 10133 10138 10149 10150 10151 10152 10153 10154 10155 10156
    ##  [73] 10157 10158 10159 10160 10161 10163 10164 10165 10166 10167 10168 10169
    ##  [85] 10170 10171 10172 10173 10174 10175 10176 10177 10178 10179 10185 10197
    ##  [97] 10199 10213 10242 10249 10256 10259 10260 10261 10265 10268 10269 10270
    ## [109] 10271 10272 10273 10274 10275 10276 10277 10278 10279 10281 10285 10286
    ## [121] 10292 11001 11004 11005 11040 11096 11351 11352 11359 11362 11363 11371
    ## [133] 11380 11381 11386 11405 11411 11412 11413 11414 11416 11417 11419 11420
    ## [145] 11421 11422 11423 11424 11425 11427 11428 11429 11430 11431 11433 11436
    ## [157] 11439 11451 11499 11559 11580 11690 11694 11695 11697 10302 10307 10309
    ## [169] 10310 10311 10313

These zip codes might denotes sparsely populated or remote areas, as
Zillow’s data is mainly based on active rental markets and available
listings. If a ZIP code has very few or no rental properties, data may
be missing. The fact that these ZIP codes are all associated with
neighborhoods Northest Bronx, Southern Brooklyn, etc. further
corroborates this explanation.

``` r
jan_prices <- housing_by_zip_df %>%
  filter(substr(date, 1, 7) %in% c("2020_01", "2021_01")) %>%
  select(zip_code, county, neighborhood, date, price) %>% 
  pivot_wider(
    names_from = date,
    values_from = price
  ) %>% 
  mutate(price_drop = `2020_01_31` - `2021_01_31`) %>% 
  knitr::kable()
jan_prices
```

| zip_code | county | neighborhood | 2020_01_31 | 2021_01_31 | price_drop |
|---:|:---|:---|---:|---:|---:|
| 11385 | Queens | West Central Queens | 2509.859 | 2292.884 | 216.974543 |
| 10467 | Bronx | Bronx Park and Fordham | 1649.561 | 1744.514 | -94.952855 |
| 11226 | Kings | Flatbush | 2357.056 | 2180.768 | 176.287750 |
| 11207 | Kings | East New York and New Lots | 2418.346 | 2142.852 | 275.493486 |
| 10025 | New York | Upper West Side | 3285.527 | 2794.104 | 491.423473 |
| 11214 | Kings | Southwest Brooklyn | NA | 1797.926 | NA |
| 11220 | Kings | Sunset Park | 2134.505 | 2139.880 | -5.374370 |
| 11206 | Kings | Bushwick and Williamsburg | 2994.417 | 2573.395 | 421.022482 |
| 11221 | Kings | Bushwick and Williamsburg | 2602.640 | 2336.161 | 266.479720 |
| 11223 | Kings | Southern Brooklyn | NA | 1791.493 | NA |
| 11230 | Kings | Borough Park | 2336.111 | 2158.901 | 177.210103 |
| 10458 | Bronx | Bronx Park and Fordham | 1375.976 | 1420.382 | -44.405629 |
| 11377 | Queens | West Queens | NA | 2051.650 | NA |
| 11235 | Kings | Southern Brooklyn | 2005.151 | 1898.840 | 106.311058 |
| 11229 | Kings | Southern Brooklyn | 1782.824 | 1797.040 | -14.215796 |
| 11233 | Kings | Central Brooklyn | 2340.671 | 2188.784 | 151.886275 |
| 11355 | Queens | North Queens | 1994.899 | 1909.678 | 85.221232 |
| 11203 | Kings | Flatbush | NA | 2228.270 | NA |
| 10457 | Bronx | Central Bronx | 1850.370 | 1848.517 | 1.853063 |
| 10029 | New York | East Harlem | 2543.890 | 2134.239 | 409.651095 |
| 11218 | Kings | Borough Park | 2192.059 | 2134.869 | 57.189168 |
| 10462 | Bronx | Southeast Bronx | 1681.766 | 1706.894 | -25.128710 |
| 10002 | New York | Lower East Side | 3645.416 | 2935.113 | 710.302813 |
| 11375 | Queens | West Central Queens | 2216.311 | 2113.249 | 103.062356 |
| 11215 | Kings | Northwest Brooklyn | 2899.998 | 2686.916 | 213.082156 |
| 10463 | Bronx | Kingsbridge and Riverdale | 2169.420 | 2205.920 | -36.500101 |
| 10463 | New York | Kingsbridge and Riverdale | 2169.420 | 2205.920 | -36.500101 |
| 11209 | Kings | Southwest Brooklyn | 1871.141 | 1863.056 | 8.085677 |
| 11213 | Kings | Central Brooklyn | 2446.179 | 2210.337 | 235.841443 |
| 11201 | Kings | Northwest Brooklyn | 3454.475 | 3129.932 | 324.542897 |
| 11201 | New York | Northwest Brooklyn | 3454.475 | 3129.932 | 324.542897 |
| 11210 | Kings | Flatbush | 2389.201 | 2244.515 | 144.686224 |
| 11432 | Queens | Jamaica | 1894.911 | 1996.113 | -101.202050 |
| 10027 | New York | Central Harlem | 2809.327 | 2493.545 | 315.782127 |
| 11211 | Kings | Greenpoint | 3425.755 | 2987.817 | 437.938092 |
| 10024 | New York | Upper West Side | 3188.124 | 2680.001 | 508.122919 |
| 10032 | New York | Inwood and Washington Heights | 2243.763 | 2049.605 | 194.158778 |
| 11216 | Kings | Central Brooklyn | 2520.564 | 2289.581 | 230.982944 |
| 10023 | New York | Upper West Side | 3438.899 | 2895.110 | 543.789014 |
| 10033 | New York | Inwood and Washington Heights | 2301.512 | 2144.401 | 157.111292 |
| 11238 | Kings | Central Brooklyn | 3017.018 | 2769.830 | 247.188060 |
| 11435 | Queens | Jamaica | NA | 1800.737 | NA |
| 10031 | New York | Inwood and Washington Heights | 2418.476 | 2163.701 | 254.775517 |
| 11225 | Kings | Flatbush | 2551.988 | 2303.947 | 248.041458 |
| 10128 | New York | Upper East Side | 2916.793 | 2404.080 | 512.712825 |
| 10009 | New York | Lower East Side | 3406.442 | 2692.187 | 714.254997 |
| 11354 | Queens | North Queens | 2104.444 | 2059.711 | 44.733333 |
| 10003 | New York | Lower East Side | 3569.784 | 2897.243 | 672.540447 |
| 10016 | New York | Gramercy Park and Murray Hill | 3731.135 | 3019.431 | 711.704460 |
| 10461 | Bronx | Southeast Bronx | 1922.047 | 1905.592 | 16.455354 |
| 10011 | New York | Chelsea and Clinton | 4104.074 | 3441.907 | 662.166371 |
| 11205 | Kings | Northwest Brooklyn | 2966.482 | 2643.344 | 323.138236 |
| 11237 | Kings | Bushwick and Williamsburg | 2678.741 | 2354.958 | 323.783091 |
| 11374 | Queens | West Central Queens | 2228.457 | 2174.793 | 53.663446 |
| 10040 | New York | Inwood and Washington Heights | 1950.314 | 1852.431 | 97.882665 |
| 10019 | New York | Chelsea and Clinton | 3505.284 | 2970.017 | 535.267230 |
| 10028 | New York | Upper East Side | 2828.060 | 2339.623 | 488.436630 |
| 10304 | Richmond | Stapleton and St. George | NA | 2019.621 | NA |
| 10034 | New York | Inwood and Washington Heights | 1996.546 | 1933.507 | 63.038684 |
| 11217 | Kings | Northwest Brooklyn | 3165.211 | 2881.246 | 283.964777 |
| 11249 | Kings | NA | 3829.301 | 3614.359 | 214.942464 |
| 10021 | New York | Upper East Side | 3048.371 | 2564.906 | 483.465584 |
| 11222 | Kings | Greenpoint | 3089.008 | 2866.365 | 222.643951 |
| 11231 | Kings | Northwest Brooklyn | 3256.772 | 3060.580 | 196.192228 |
| 11105 | Queens | Northwest Queens | NA | 2043.440 | NA |
| 11106 | Queens | Northwest Queens | 2404.438 | 2209.782 | 194.655837 |
| 10026 | New York | Central Harlem | 2699.708 | 2359.972 | 339.736247 |
| 10035 | New York | East Harlem | 2545.423 | 2303.575 | 241.848823 |
| 11101 | Queens | Northwest Queens | 3275.572 | 3147.338 | 128.233510 |
| 11103 | Queens | Northwest Queens | 2139.130 | 2041.694 | 97.435839 |
| 10022 | New York | Gramercy Park and Murray Hill | 3471.454 | 2852.829 | 618.625428 |
| 10010 | New York | Gramercy Park and Murray Hill | 3697.284 | 3012.353 | 684.930363 |
| 10030 | New York | Central Harlem | 2192.785 | 2016.737 | 176.048402 |
| 10014 | New York | Greenwich Village and Soho | 3768.250 | 3188.487 | 579.763192 |
| 11361 | Queens | Northeast Queens | NA | 1963.652 | NA |
| 11232 | Kings | Sunset Park | NA | 2276.258 | NA |
| 10065 | New York | Upper East Side | 3263.389 | 2767.429 | 495.959602 |
| 10013 | New York | Greenwich Village and Soho | 4431.870 | 3797.818 | 634.052140 |
| 11102 | Queens | Northwest Queens | 2457.064 | 2293.716 | 163.348111 |
| 10075 | New York | Upper East Side | 2567.108 | 2159.000 | 408.107880 |
| 10036 | New York | Chelsea and Clinton | 3450.481 | 2823.714 | 626.767081 |
| 10001 | New York | Chelsea and Clinton | 4108.098 | 3397.648 | 710.449930 |
| 11104 | Queens | Northwest Queens | NA | 1947.880 | NA |
| 10039 | New York | Central Harlem | NA | 2187.824 | NA |
| 10038 | New York | Lower Manhattan | 3573.201 | 2875.616 | 697.585253 |
| 10012 | New York | Greenwich Village and Soho | 3628.566 | 2942.344 | 686.221828 |
| 10037 | New York | Central Harlem | 2236.356 | 2100.757 | 135.599109 |
| 11415 | Queens | Southwest Queens | NA | 1839.916 | NA |
| 10017 | New York | Gramercy Park and Murray Hill | 3314.827 | 2793.413 | 521.414738 |
| 10005 | New York | Lower Manhattan | 3407.590 | 2917.899 | 489.691289 |
| 10007 | New York | Lower Manhattan | 6334.211 | 5421.614 | 912.596591 |
| 10018 | New York | Chelsea and Clinton | 3893.485 | 3314.233 | 579.252194 |
| 10069 | New York | NA | 4623.042 | 3874.918 | 748.124509 |
| 10280 | New York | Lower Manhattan | 3598.339 | 3136.414 | 461.925539 |
| 11109 | Queens | NA | 3291.922 | 3288.707 | 3.214583 |
| 10006 | New York | Lower Manhattan | NA | 2956.051 | NA |
| 10004 | New York | Lower Manhattan | 3149.658 | 2443.697 | 705.960808 |

Most ZIP codes experienced a significant drop, with the largest decrease
exceeding nine hundred dollars, occurring in Lower Manhattan. However,
since its original price was also high, the percentage decrease is
comparable to other areas.
